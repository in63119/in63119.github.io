---
title: let과 const 그리고 할당
author: IN
date: 2022-12-9 13:56:00 +0800
categories: [Blogging, Javascript]
tags: [wallet, Monkey]
pin: true
---

기존 프로젝트를 리팩토링 하던 중 아주 초보적인 깨달음을 얻어 블로깅을 한다.
<br />
앞으로 초보적인 실수는 [Monkey]라는 태그로 잊지 않도록 모아놓을 것이다.
<br />

이번에는 소수점 넷째자리 까지만 보여주도록 변경해보겠다.

<br />

```
예를 들어, 0.444445라는 잔액이 있다면
0.4444 까지만 보여주도록 할 것이다.
```

<br />
<br />

## 기존 잔액 표기

기존 월렛의 잔액 표시는 다음과 같이 긴 소수점을 보여주고 있었다.

<br />

<img width="569" alt="배포 잔액" src="https://user-images.githubusercontent.com/65399118/205914699-7245a963-dd4a-4fdf-bc1b-d2aeb83bccce.png">

<br />

### 코드

다음은 web3-js를 이용하여 해당 `address`의 잔액을 가져와서 `fromWei`로 단위를 변경 시켜주는 코드이다.

<br />

```js
// 잔액 조회
export async function getBalance(address) {
  const balance = await web3.eth.getBalance(address).then((data) => {
    return data;
  });
  const convertBalance = await web3.utils.fromWei(`${balance}`, "ether");

  return convertBalance;
}
```

<br />

## 소수점 넷째자리까지 표기하기

이제 다음과 같이 잔액을 네째자리 까지만 보여주는 코드로 수정해보자.

<br />

<img width="569" alt="로컬 잔액" src="https://user-images.githubusercontent.com/65399118/205915355-6e128e57-02e2-4a84-bfc7-f8e3afe10a67.png">

<br />

### 코드

```js
// 잔액 조회
export async function getBalance(address) {
  const balance = await web3.eth.getBalance(address).then((data) => {
    return data;
  });
  const convertBalance = await web3.utils.fromWei(`${balance}`, "ether");

  let floorBalance;
  let decimal;
  let sliceIndex = 0;

  // convertBalance를 만지기 쉽게 배열로 만들어준다.
  const arrayBalance = convertBalance.split("");

  // 소수점(".")이 몇 번 인덱스인지 찾는다.
  for (let i = 0; i < arrayBalance.length; i++) {
    if (arrayBalance[i] === ".") {
      sliceIndex = i;
      break;
    }
  }

  // 0 이상의 양의 정수는 제외하고 소수점부터만 변수에 저장한다.
  decimal = convertBalance.slice(sliceIndex + 1);

  // 만약, 소수점 넷째자리보다 커지면 반올림시킨다.
  if (decimal.length > 4) {
    floorBalance = Number(convertBalance).toFixed(4);
    return floorBalance;
  }

  // 아니면, 기존 그대로 리턴
  return convertBalance;
}
```

<br />

### 다른 체인의 잔액도 확인해보자.

- 소수점 첫째자리로 떨어질 때

<img width="569" alt="바이낸스 잔액" src="https://user-images.githubusercontent.com/65399118/205933919-27a76bdc-364c-409f-ad79-4163d0badf7b.png">

<br />

- 0 이상의 정수 포함한 소수 넷째자리 표기

<img width="569" alt="클레이튼 잔액" src="https://user-images.githubusercontent.com/65399118/205934813-d59bcbf9-b99d-47ba-b8cf-7b3e90fdb88c.png">
